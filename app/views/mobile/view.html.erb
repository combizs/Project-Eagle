<div data-role="page" data-theme="a">

  <%= render :partial => "header", :locals => { :app => @app } %>

  <div class="content">
  		<div class='box' id='topbox'>
			<a href=""><img src="<%= @app.course_info['logo'] %>" style="width:83px;height:120px;float:left;margin:8px;margin-left:2px" /></a>
			<div class='title' style='margin-top:-10px;padding-top:65px;font-size:18px'>
				<b><%= @app.course_info['title'] %></b>
				<div style='margin-top:-2px'>
					<span style='font-size:14px;color:#555'><%= @app.course_info['address']['city'] %>, <%= @app.course_info['address']['state'] %></span>
				</div>

				<div style='margin-top:3px;border-top:1px solid gray;font-weight:normal;font-size:14px;padding-top:4px'>
					<b style='color:green'>Booking #</b>: <%=@app.reservation.confirmation_code[0..20]%>
				</div>
			</div>
			
			<div style='clear:both;height:0px'></div>
			
			<div style='margin-top:5px'>
				<strong>Name: </strong> <%=@app.user.f_name%> <%=@app.user.l_name%> <br>
				<strong>Date: </strong><%=@app.reservation.date.to_date.strftime("%A, %B %e")%><br>
				<strong>Tee Time: </strong><%=Time.parse(@app.reservation.time).strftime("%I:%M %p")%><br>  
				<strong>Number of Golfers: </strong><%=@app.reservation.golfers%><br>
				<strong>Total Due at Course: </strong>$<%=@app.reservation.total%>.00
			</div>
			
			<% @code = @app.reservation.confirmation_code %>
			<center><a href="javascript:cancelTime('<%= @code %>');" class='cancel_button' style='margin-top:10px;border-radius:6px;'>Cancel Reservation</a></center>
  <script src="https://checkout.stripe.com/v2/checkout.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>

			<center><button id="customButton">Purchase Online</button></center>

  <script>
    $('#customButton').click(function(){
      var token = function(res){
        var $input = $('<input type=hidden name=stripeToken />').val(res.id);
        $('form').append($input).submit();
      };

      StripeCheckout.open({
        key:         'pk_test_2yvhQN0YU3zvKbzifhyDwNnl',
        address:     true,
        amount:      <%=@app.reservation.total%>00,
        currency:    'usd',
        name:        '<%=@app.user.f_name%> <%=@app.user.l_name%>',
        description: 'A bag of Pistachios',
        panelLabel:  'Checkout',
        token:       token
      });

      return false;
    });
  </script>
		</div>
 </div>	

 <%= render :partial => "footer", :locals => { :app => @app } %>

</div>